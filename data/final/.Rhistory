} else{
year[i] <- paste0(19, year.2digit[i])
}
}
lowArea$Year <- year
plot(x = lowArea$Year,
y = lowArea$AreaAll,
xlab = "Year",
ylab = "Area",)
# Look at GLU only STDs
w <- data[data$AAID == "GLU" &
data$ID1 == "5AA",]
lm <- lm(adj ~ AreaAll, data = w)
summary(lm)
plot(x = w$AreaAll,
y = w$adj,
xlab = "Area",
ylab = "d15N",
main = "GLU - Standards"
)
abline(lm)
# Look at GLU and repeat above
y <- data[data$AAID == "GLU" &
!data$ID1 == "5AA",]
lm <- lm(adj ~ AreaAll, data = y)
summary(lm)
plot(x = y$AreaAll,
y = y$adj,
xlab = "Area",
ylab = "d15N",
main = "GLU"
)
abline(lm)
library(ggplot)
library(ggplot2)
# Correction to bump up values with low Area
ggplot(data = y,
aes(x = AreaAll,
y = adj)) +
geom_point(size = 3, alpha = 0.7) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE)
# Correction to bump up values with low Area
ggplot(data = y,
aes(x = AreaAll,
y = adj)) +
geom_point(size = 3, alpha = 0.7) +
geom_smooth(method = "nls", formula = y ~ a * x^b, se = FALSE)
#this is an r script to do some basic data visualization of the cleaned data
#at this point the data should be drift corrected, compiled, and had all
#duplicates and replicates removed and averaged
rm(list =ls())
setwd("~/Documents/GitHub/CSIA_lab_work/data/final")
#load packages
library(dplyr)
library(readr)
library(ggplot2)
library(ggpubr)
#read in the main data file
data <- read.csv(file="data.csv")
# remove 07_K_2 because of mass effects
data <- data[data$Sample.ID != "07_K_2",]
PHE.all <- ggplot(data = data, aes(x = Year, y = PHE.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Phenylalanine (source) Signature Through Time",
x = "Year",
y = "PHE d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
PHE.all
#read in the main data file
data <- read.csv(file="data.csv")
# remove 07_K_2 because of mass effects
data <- data[data$Sample.ID != "07_K_2",]
#main graphs with trend line
PHE.all <- ggplot(data = data, aes(x = Year, y = PHE.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Phenylalanine (source) Signature Through Time",
x = "Year",
y = "PHE d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
PHE.all
GLU.all <- ggplot(data = data, aes(x = Year, y = GLU.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Glutamic Acid (trophic) Signature Through Time",
x = "Year",
y = "GLU d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
GLU.all
GLU.all <- ggplot(data = data, aes(x = Year, y = GLU.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Glutamic Acid (trophic) Signature Through Time",
x = "Year",
y = "GLU d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
GLU.all
setwd("~/Documents/GitHub/CSIA_lab_work/data")
#Load Packages
library(dplyr)
library(ggplot2)
library(tidyr)
library(lubridate)
#Load Data
data <- read.csv(file = "final/data.csv")
PDO <- read.csv(file = "Environmental/PDO.csv")
#### Convert PDO to tidy format ####
PDO_long <- gather(PDO, Month, Value, -Year)
#sort by year
PDO_long <- arrange(PDO_long, Year)
#convert month to date
PDO_long <- PDO_long %>%
mutate(month_number = match(Month, month.abb))
#### Average GLU ###
avg_glu <- data %>%
group_by(Year) %>%
summarise(GLU = mean(GLU.mean, na.rm = TRUE))
plot(x = avg_glu$Year,
y = avg_glu$PHE,
xlab = "Year",
ylab = "GLU signature")
plot(x = avg_glu$Year,
y = avg_glu$GLU,
xlab = "Year",
ylab = "GLU signature")
plot(x = avg_glu$Year,
y = avg_glu$GLU,
xlab = "Year",
ylab = "GLU signature",
type = "l")
#### Trophic Position ####
tp <- subset(data, select = c(Year, Trophic.Position))
avg_tp <- tp %>%
group_by(Year) %>%
summarise(Trophic.Position = mean(Trophic.Position, na.rm = TRUE))
avg_tp <- tp %>%
group_by(Year) %>%
summarise(Trophic.Position = mean(Trophic.Position, na.rm = TRUE))
plot(x = avg_tp$Year,
y = avg_tp$Trophic.Position,
type ="l")
#this is an r script to do some basic data visualization of the cleaned data
#at this point the data should be drift corrected, compiled, and had all
#duplicates and replicates removed and averaged
rm(list =ls())
setwd("~/Documents/GitHub/CSIA_lab_work/data/final")
#load packages
library(dplyr)
library(readr)
library(ggplot2)
library(ggpubr)
#read in the main data file
data <- read.csv(file="data.csv")
# remove 07_K_2 because of mass effects
data <- data[data$Sample.ID != "07_K_2",]
trophic.all <- ggplot(data = data, aes(x = Year, y = Trophic.Position, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Trophic Position",
x = "Year",
y = "Trophic Position") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
trophic.all
trophic.all <- ggplot(data = data, aes(x = Year, y = Trophic.Position, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Trophic Position",
x = "Year",
y = "Trophic Position") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
geom_vline(xintercept=1977, linetype ="dashed") +
geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
trophic.all
# subset three year time periods
period1 <- data[data$Year >= 1965 & data$Year <= 1976,]
View(period1)
period2 <- data[data$Year >= 1977 & data$Year <= 1998,]
period3 <- data[data$Year >= 1999 & data$Year <= 2022,]
# average PHE for each period
avg_phe1 <- period1 %>%
group_by(Year) %>%
summarise(PHE = mean(PHE.mean, na.rm = TRUE))
View(avg_phe1)
# average PHE for each period
avg_phe1 <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2 <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3 <- period3$PHE.mean %>% mean(na.rm = TRUE)
# subset three year time periods
period1 <- data[data$Year >= 1965 & data$Year <= 1976,]
period2 <- data[data$Year >= 1977 & data$Year <= 2000,]
period3 <- data[data$Year >= 1999 & data$Year <= 2022,]
# average PHE for each period
avg_phe1 <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2 <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3 <- period3$PHE.mean %>% mean(na.rm = TRUE)
# subset three year time periods (based on PDO)
period1 <- data[data$Year >= 1965 & data$Year <= 1976,]
period2 <- data[data$Year >= 1977 & data$Year <= 2000,]
period3 <- data[data$Year >= 1999 & data$Year <= 2022,]
# average PHE for each period
avg_phe1 <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2 <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3 <- period3$PHE.mean %>% mean(na.rm = TRUE)
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1976, y = avg_phe1, yend = avg_phe1, color = "red") +
geom_segment(x = 1977, xend = 2000, y = avg_phe2, yend = avg_phe2, color = "blue") +
geom_segment(x = 1999, xend = 2022, y = avg_phe3, yend = avg_phe3, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
# subset three year time periods (based visually where the breaks seem to be)
period1.b <- data[data$Year >= 1965 & data$Year <= 1976,]
period2.b <- data[data$Year >= 1977 & data$Year <= 2005,]
period3.b <- data[data$Year >= 2005 & data$Year <= 2022,]
# average PHE for each period
avg_phe1.b <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2.b <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3.b <- period3$PHE.mean %>% mean(na.rm = TRUE)
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1976, y = avg_phe1.b, yend = avg_phe1.b, color = "red") +
geom_segment(x = 1977, xend = 2000, y = avg_phe2.b, yend = avg_phe2.b, color = "blue") +
geom_segment(x = 1999, xend = 2022, y = avg_phe3.b, yend = avg_phe3.b, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
# subset three year time periods (based visually where the breaks seem to be)
period1.b <- data[data$Year >= 1965 & data$Year <= 1976,]
period2.b <- data[data$Year >= 1977 & data$Year <= 2005,]
period3.b <- data[data$Year >= 2006 & data$Year <= 2022,]
# average PHE for each period
avg_phe1.b <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2.b <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3.b <- period3$PHE.mean %>% mean(na.rm = TRUE)
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1976, y = avg_phe1.b, yend = avg_phe1.b, color = "red") +
geom_segment(x = 1977, xend = 2005, y = avg_phe2.b, yend = avg_phe2.b, color = "blue") +
geom_segment(x = 2006, xend = 2022, y = avg_phe3.b, yend = avg_phe3.b, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
# subset three year time periods (based visually where the breaks seem to be)
period1.b <- data[data$Year >= 1965 & data$Year <= 1979,]
period2.b <- data[data$Year >= 1980 & data$Year <= 2005,]
period3.b <- data[data$Year >= 2006 & data$Year <= 2022,]
# average PHE for each period
avg_phe1.b <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2.b <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3.b <- period3$PHE.mean %>% mean(na.rm = TRUE)
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1979, y = avg_phe1.b, yend = avg_phe1.b, color = "red") +
geom_segment(x = 1980, xend = 2005, y = avg_phe2.b, yend = avg_phe2.b, color = "blue") +
geom_segment(x = 2006, xend = 2022, y = avg_phe3.b, yend = avg_phe3.b, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
# subset three year time periods (based visually where the breaks seem to be)
period1.b <- data[data$Year >= 1965 & data$Year <= 1982,]
period2.b <- data[data$Year >= 1983 & data$Year <= 2005,]
period3.b <- data[data$Year >= 2006 & data$Year <= 2022,]
# average PHE for each period
avg_phe1.b <- period1$PHE.mean %>% mean(na.rm = TRUE)
avg_phe2.b <- period2$PHE.mean %>% mean(na.rm = TRUE)
avg_phe3.b <- period3$PHE.mean %>% mean(na.rm = TRUE)
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1982, y = avg_phe1.b, yend = avg_phe1.b, color = "red") +
geom_segment(x = 1983, xend = 2005, y = avg_phe2.b, yend = avg_phe2.b, color = "blue") +
geom_segment(x = 2006, xend = 2022, y = avg_phe3.b, yend = avg_phe3.b, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
ggplot(data = data, aes(x = Year, y = PHE.mean)) +
geom_point(size = 3, alpha = 0.7) +
geom_segment(x = 1965, xend = 1976, y = avg_phe1, yend = avg_phe1, color = "red") +
geom_segment(x = 1977, xend = 2000, y = avg_phe2, yend = avg_phe2, color = "blue") +
geom_segment(x = 1999, xend = 2022, y = avg_phe3, yend = avg_phe3, color = "green") +
labs(title = "Average Phenylalanine (PHE) Across Time Periods",
x = "Year",
y = "Average PHE") +
theme_minimal()
#this is an r script to do some basic data visualization of the cleaned data
#at this point the data should be drift corrected, compiled, and had all
#duplicates and replicates removed and averaged
rm(list =ls())
setwd("~/Documents/GitHub/CSIA_lab_work/data/final")
#load packages
library(dplyr)
library(readr)
library(ggplot2)
library(ggpubr)
#read in the main data file
data <- read.csv(file="data.csv")
# remove 07_K_2 because of mass effects
data <- data[data$Sample.ID != "07_K_2",]
#main graphs with trend line
PHE.all <- ggplot(data = data, aes(x = Year, y = PHE.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Phenylalanine (source) Signature Through Time",
x = "Year",
y = "PHE d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
# geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
PHE.all
PHE.all <- ggplot(data = data, aes(x = Year, y = PHE.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Phenylalanine (source) Signature Through Time",
x = "Year",
y = "PHE d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
# geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
PHE.all
GLU.all <- ggplot(data = data, aes(x = Year, y = GLU.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Glutamic Acid (trophic) Signature Through Time",
x = "Year",
y = "GLU d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
#geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
GLU.all
GLU.all <- ggplot(data = data, aes(x = Year, y = GLU.mean, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Glutamic Acid (trophic) Signature Through Time",
x = "Year",
y = "GLU d15N") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
#geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
trophic.all <- ggplot(data = data, aes(x = Year, y = Trophic.Position, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Trophic Position",
x = "Year",
y = "Trophic Position") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
#geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group=1))
trophic.all
trophic.all <- ggplot(data = data, aes(x = Year, y = Trophic.Position, color = System)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Trophic Position",
x = "Year",
y = "Trophic Position") +
theme(axis.title = element_text(size = 15),
plot.title = element_text(size=16)) +
#geom_vline(xintercept=1977, linetype ="dashed") +
#geom_vline(xintercept=1998, linetype ="dashed") +
geom_smooth(aes(group = System), method = "loess", se = FALSE)
trophic.all
rm(list=ls())
library(HEEL)
apr10 <- read.csv(file = "04:10:2024/sample_CN.csv")
apr08 <- read.csv(file = "04:08:2024/sample_CN.csv")
#extract data from all csv files
setwd("~/Documents/GitHub/CSIA_lab_work/data/EA results/processed")
apr10 <- read.csv(file = "04:10:2024/sample_CN.csv")
apr08 <- read.csv(file = "04:08:2024/sample_CN.csv")
apr03 <- read.csv(file = "04:03:2024/sample_CN.csv")
mar29 <- read.csv(file = "03:29:2024/sample_CN.csv")
mar28 <- read.csv(file = "03:28:2024/sample_CN.csv")
mar27 <- read.csv(file = "03:27:2024/sample_CN.csv")
mar26 <- read.csv(file = "03:26:2024/sample_CN.csv")
mar25 <- read.csv(file = "03:25:2024/sample_CN.csv")
View(mar27)
#combine into one sheet
library(dplyr)
combined_df <- bind_rows(apr03, apr08, mar25, mar26, mar27, mar28, mar29)
View(combined_df)
View(combined_df)
substr(combined_df$Identifier.1, 1, 7)
substr(combined_df$Identifier.1, 1, 3)
substr(combined_df$Identifier.1, 1, 2)
#get rid of standards
STD <- c("NOR"< "ALA", "VAL", "PHE", "GLU")
#get rid of standards
STD <- c("NOR", "ALA", "VAL", "PHE", "GLU")
substr(combined_df$Identifier.1, 1, 3)
which(substr(combined_df$Identifier.1, 1, 3) == STD)
which(substr(combined_df$Identifier.1, 1, 3) == "NOR")
which(substr(combined_df$Identifier.1, 1, 3) == "NOR" |
which(substr(combined_df$Identifier.1, 1, 3) == "NOR" |
substr(combined_df$Identifier.1, 1, 3) == "ALA" |
substr(combined_df$Identifier.1, 1, 3) == "VAL" |
substr(combined_df$Identifier.1, 1, 3) == "PHE" |
substr(combined_df$Identifier.1, 1, 3) == "GLU")
which(substr(combined_df$Identifier.1, 1, 3) == "NOR" |
which(substr(combined_df$Identifier.1, 1, 3) == "NOR" |
substr(combined_df$Identifier.1, 1, 3) == "ALA" |
substr(combined_df$Identifier.1, 1, 3) == "VAL" |
substr(combined_df$Identifier.1, 1, 3) == "PHE" |
substr(combined_df$Identifier.1, 1, 3) == "GLU")
index <- which(substr(combined_df$Identifier.1, 1, 3) == "NOR" |
substr(combined_df$Identifier.1, 1, 3) == "ALA" |
substr(combined_df$Identifier.1, 1, 3) == "VAL" |
substr(combined_df$Identifier.1, 1, 3) == "PHE" |
substr(combined_df$Identifier.1, 1, 3) == "GLU")
#remove indexed rows from combined_df
Corrected <- combined_df[-index,]
combined_df <- combined_df[-index,]
no_std <- combined_df[-index,]
View(no_std)
substr(combined_df$Identifier.1, 1, 2)
#add year column
year.2digit <- substr(combined_df$Identifier.1, 1, 2)
year <- vector(mode="character")
for(i in 1:length(year.2digit)){
if(year.2digit[i] <= 22){
year[i] <- paste0(20, year.2digit[i])
} else{
year[i] <- paste0(19, year.2digit[i])
}
}
combined_df$Year <- year
combined_df <- Corrected %>% relocate(Year, .before = Row)
no_std$Year <- year
no_std <- Corrected %>% relocate(Year, .before = Row)
#add year column
year.2digit <- substr(no_std$Identifier.1, 1, 2)
year <- vector(mode="character")
for(i in 1:length(year.2digit)){
if(year.2digit[i] <= 22){
year[i] <- paste0(20, year.2digit[i])
} else{
year[i] <- paste0(19, year.2digit[i])
}
}
no_std$Year <- year
no_std <- Corrected %>% relocate(Year, .before = Row)
no_std$Year <- year
no_std <- no_std %>% relocate(Year, .before = Row)
#plot
plot(x = no_std$Year,
y = no_std$d.15N.14N.air)
#add system column
sys <- substr(no_std$Identifier.1, 4, 4)
sys
#add age column
no_std$Age <- substr(no_std$Identifier.1, 6, 6)
no_std <- no_std %>% relocate(Age, .before = ALA.mean)
#add age column
no_std$Age <- substr(no_std$Identifier.1, 6, 6)
no_std <- no_std %>% relocate(Age, .before = Row)
substr(no_std$Identifier.1, 6, 6)
#add age column
no_std$Age <- substr(no_std$Identifier.1, 6, 7)
substr(no_std$Identifier.1, 7, 7)
#add age column
no_std$Age <- substr(no_std$Identifier.1, 7, 7)
View(no_std)
no_std <- no_std %>% relocate(Age, .before = Row)
#plot
ggplot(data = no_std,
aes(x = Year, y = d.15.14N.air, color = Age))
#plot
ggplot(data = no_std,
aes(x = Year, y = d.15.14N.air, color = Age)) +
geom_point(size = 3, alpha = 0.7) +
#group samples
grouped_df <- combined_df %>%
group_by(group_id = substr(Identifier.1, 1, 7)) %>%
summarize_all(mean, na.rm = TRUE)
#plot
ggplot(data = no_std,
aes(x = Year, y = d.15.14N.air, color = Age)) +
geom_point(size = 3, alpha = 0.7)
str(no_std)
#plot
ggplot(data = no_std,
aes(x = Year, y = d.15N.14N.air, color = Age)) +
geom_point(size = 3, alpha = 0.7)
setwd("~/Documents/GitHub/CSIA_lab_work/data/final")
# Read in data
data <- read.csv(file = "~/Documents/GitHub/CSIA_lab_work/data/final/data.csv")
View(data)
View(data)
